<h3 id="formatting-with-an-external-program">Formatting with an External Program</h3>

<h4>Problem</h4>

<p>You want to reformat text with a program other than Vim. For example, you
want to use the <abbr title="World Wide Web Consortium">W3C</abbr>'s 'tidy'
utility to format <abbr title="HyperText Markup Language">HTML</abbr>.</p>

<h4>Solution</h4>

<p>Set the <tt>equalprg</tt> option to the name of the program you want
to use, along with any arguments it should be passed.  For example:</p>

<pre><code>:set equalprg=tidy\ -indent\ -q</code></pre>

<p>You can now <a href="#visually-selecting-text">select</a> the text you want
to format, then hit <kbd>=</kbd>. You can reformat the entire file with
<kbd>1G=G</kbd>.</p>

<h4>Discussion</h4>

<p>The formatter that you use depends on the type of content you are
producing.  Here are a couple of suggestions of programs to use for specific
file types:</p>

<h5>Text</h5>

<p>If you want to format normal text using an external program, <tt>par</tt>
is a popular choice. It can wrap, align, justify, and quote text in every
conceivable way, and many more aside.</p>

<h5>HTML/XHTML</h5>

<p>Use <a href="http://tidy.sourceforge.net/"><em>HTML Tidy</em></a>. You can
specify options on the command line, as shown in the example above. If you
want to specify a lot of options, put them into a config file, and point
<tt>tidy</tt> to it: <tt>tidy
  --config <var>file</var></tt>. At a minimum you probably want to use:</p>

<pre><code>:setlocal equalprg=tidy\ -utf8\ -indent\ -q\ -f\ /tmp/err</code></pre>

<p>Then you can reformat your file with <kbd>1G=G</kbd>. One caveat is that
this won't work correctly for reformatting a specific section of the file. You
can use the <tt>--show-body-only true</tt> option if you want to be able to do
this, but like many formatters of markup languages, Tidy doesn't perform as
well on fragments because of lack of context.</p>

<h5>XML</h5>

<p><em>HTML Tidy</em> can be used to format XML as well by passing it the
<tt>-xml</tt> option. Alternatively, you can use <tt>xmllint</tt>:</p>

<pre><code>:set equalprg=xmllint\ --format\ -</code></pre>  
